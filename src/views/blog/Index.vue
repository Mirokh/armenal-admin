<template>  <div>    <div class="row q-py-md q-px-md justify-between">      <h5 class="q-ma-xs">        News      </h5>      <q-btn color="primary" size="md" label="Add new" icon="add" @click="create"/>    </div>    <q-separator inset class="q-my-sm"/>    <template v-if="loading">      <TableSkeleton></TableSkeleton>    </template>    <template v-else>      <div class="q-pa-md">        <q-table            :grid="$q.screen.xs"            :rows="rows"            :columns="columns"            row-key="name"            :filter="filter"        >          <template v-slot:top-right>            <q-input borderless dense debounce="300" v-model="filter" placeholder="Search">              <template v-slot:append>                <q-icon name="search"/>              </template>            </q-input>          </template>          <template v-slot:body-cell-imagePath="props">            <q-td :props="props" auto-width>              <img v-if="props.row.imagePath" :src="imageUrl(props.row.imagePath)" alt="" width="60" height="60">              <q-icon v-else size="sm" :name="icons.brokenImage"></q-icon>            </q-td>          </template>          <template v-slot:body-cell-text="props">            <q-td :props="props" auto-width>              <p class="q-ma-none" v-html="truncate(props.row.text.ru, 50)"></p>            </q-td>          </template>          <template v-slot:body-cell-actions="props">            <q-td :props="props" auto-width>              <q-btn flat round color="grey" :icon="icons.edit" @click="edit(props.row.id)"/>              <q-btn flat round color="grey" :icon="icons.delete" @click="askForDelete(props.row.id)"/>            </q-td>          </template>        </q-table>      </div>    </template>    <q-dialog v-model="confirm" persistent transition-show="scale" transition-hide="scale">      <q-card class="bg-teal text-white" style="width: 300px">        <q-card-section>          <div class="text-h6">Confirm to delete</div>        </q-card-section>        <q-card-section class="q-pt-none">          Are you sure to delete this article.        </q-card-section>        <q-card-actions align="right" class="bg-white text-teal">          <q-btn flat label="Cancel" color="primary" v-close-popup />          <q-btn flat label="Accept" @click="deleteArticle" color="primary" v-close-popup />        </q-card-actions>      </q-card>    </q-dialog>  </div></template><script>import {fasPenToSquare, fasTrash, fasImage} from "@quasar/extras/fontawesome-v6";import TableSkeleton from "@/components/utils/TableSkeleton";import moment from 'moment'import {useQuasar} from "quasar";export default {  name: "BlogIndex",  components: {TableSkeleton},  data() {    return {      tempDeletingArticleId: null,      confirm: false,      loading: true,      icons: {        edit: fasPenToSquare,        delete: fasTrash,        brokenImage: fasImage      },      blogItems: [],      filter: '',      columns: [        {          label: 'Image', name: 'imagePath', field: 'imagePath', align: "left"        },        {          label: 'Title',          name: 'title',          required: true,          align: 'left',          field: row => {            return row.title.en          },          sortable: true,        },        {          name: 'text',          align: 'left',          label: 'Text',          field: row => row.text.en,          sortable: true,          format: val => `${val}`,        },        {          name: 'date', label: 'Date', field: 'createdAt', sortable: true, format: val => this.formatDate(val)        },        {          name: 'actions', align: 'left', label: 'Actions', field: 'actions', sortable: false        },      ],      rows: []    }  },  created() {    this.loading = true    this.$http.get('http://localhost:3000/blog').then((response) => {      this.rows = response.data      this.loading = false    })  },  methods: {    imageUrl(path) {      return process.env.VUE_APP_API_URL + '/' + path    },    formatDate(date) {      return moment(date).add('2').fromNow()    },    create() {      this.$router.push({name: 'news_form'})    },    edit(id) {      this.$router.push({name: 'news_form', params: {id: id}})    },    truncate(source, size) {      return source?.length > size ? source.slice(0, size - 1) + "â€¦" : source;    },    askForDelete(id) {      this.tempDeletingArticleId = id;      this.confirm = true;    },    deleteArticle() {      const token = localStorage.getItem('auth')      if (!token) {        console.error('unauthorized')        return      }      const headers = {        'Content-Type': 'multipart/form-data',        'Authorization': `Bearer ${token}`      };      this.$http.delete(`http://localhost:3000/blog/${this.tempDeletingArticleId}`, {headers}).then(() => {        this.$q.notify({          position: 'top-right',          type: 'positive',          message: 'Article deleted successfully'        })        this.loading = false      })      this.rows = this.rows.filter(obj => obj.id !== this.tempDeletingArticleId);    },  },  setup() {    const $q = useQuasar();    return {      $q    }  }}</script><style scoped></style>